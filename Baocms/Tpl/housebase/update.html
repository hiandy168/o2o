<include  file='public:header'/>
    <link href="__PUBLIC__/Scripts/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <script src="__PUBLIC__/Scripts/bootstrap/js/bootstrap.min.js"></script>
<div style="padding-left:15px;padding-right:15px;">
    <form target="baocms_frm" action="<{:U('houseBase/update?id='.$data['id'])}>" method="post">
    <table border="1" style="vertical-align: middle;text-align:center;width:100%;border: 1px solid rgb(225,225,225)">
               <tr>
            <td width="140" height="70">
                城市
            </td>
            <td style="padding-left:10px;">
                <select name="city_id" class="form-control" style="width:100px;float:left">
                    <option value=0>请选择...</option>
                    <foreach name="citys" item="vo">
                    <option value="<{$vo.city_id}>" <if condition="$data.city_id eq $vo.city_id ">selected="selected"</if>><{$vo.name}></option>
                    </foreach>
                </select>
            </td>
        </tr>
         <tr>
            <td width="140" height="70">
           楼盘名
            </td>
            <td style="padding-left:10px;">
                <input type="text" name="house_name" value="<{$data.house_name}>" class="form-control" style="width:300px;float:left" />
            </td>
        </tr>
        <tr>
            <td width="140" height="70">
                交付时间
            </td>
            <td style="padding-left:10px;">
                <input type="text" class="form-control" name="delivery_time" value="<{$data.delivery_time}>" style="width:200px;float:left" onfocus="WdatePicker({dateFmt:'yyyy-MM-dd',readOnly:true})" />
            </td>
        </tr>
        <tr>
            <td width="140" height="70">
                开盘时间
            </td>
            <td style="padding-left:10px;">
                <input type="text" class="form-control" name="open_time" value="<{$data.open_time}>" style="width:200px;float:left" onfocus="WdatePicker({dateFmt:'yyyy-MM-dd',readOnly:true})" />
            </td>
        </tr>
        <tr>
            <td width="140" height="70">
                参考均价
            </td>
            <td style="padding-left:10px;">
                <input type="text" class="form-control" name="price" value="<{$data.price}>" style="width:100px;float:left" />
                <div style="background: url('__PUBLIC__/images/ui-icons_0073ea_256x240.png') -16px -143px no-repeat;width:16px;height:16px;float:left;margin-top:10px;margin-left:5px;"></div>
                <span style="font-family: '微软雅黑';font-size:12px;color:#656c7e;float:left;margin-top:10px;margin-left:5px;">元/平方米（ 整个楼盘房屋的平均售价）</span>
            </td>
        </tr>
        <tr>
            <td width="140" height="70">
                物业费
            </td>
            <td style="padding-left:10px;">
                <input type="text" name="property_fee" value="<{$data.property_fee}>" class="form-control" style="width:100px;float:left" />
                <span style="margin-left:5px;float:left;line-height: 33px">元/平方米</span>
            </td>
        </tr>
        <tr>
            <td width="140" height="70">
                建筑面积
            </td>
            <td style="padding-left:10px;">
                <input type="text" name="build_area" value="<{$data.build_area}>" class="form-control" style="width:100px;float:left" />
            </td>
        </tr>
        <tr>
            <td width="140" height="70">
                车位
            </td>
            <td style="padding-left:10px;">
                <input type="text" name="carport" value="<{$data.carport}>" class="form-control" style="width:100px;float:left" />
                <span style="margin-left:5px;float:left;line-height: 33px">个</span>
            </td>
        </tr>
        <tr>
            <td width="140" height="70">
                绿化率
            </td>
            <td style="padding-left:10px;">
                <input type="text" name="greening_rate" value="<{$data.greening_rate}>" class="form-control" style="width:100px;float:left" />
                <span style="margin-left:5px;float:left;line-height: 33px">%</span>
            </td>
        </tr>
        <tr>
            <td width="140" height="70">
                容积率
            </td>
            <td style="padding-left:10px;">
                <input type="text" name="plot_ratio" value="<{$data.plot_ratio}>" class="form-control" style="width:100px;float:left" />
                <span style="margin-left:5px;float:left;line-height: 33px">%</span>
            </td>
        </tr>
        <tr>
            <td width="140" height="70">
                开发商
            </td>
            <td style="padding-left:10px;">
                <input type="text" name="developers" value="<{$data.developers}>" class="form-control" style="width:300px;float:left" />
            </td>
        </tr>
        <tr>
            <td width="140" height="70">
                物业公司
            </td>
            <td style="padding-left:10px;">
                <input type="text" name="property_company" value="<{$data.property_company}>" class="form-control" style="width:300px;float:left" />
            </td>
        </tr>
        <tr>
            <td width="140" height="70">
                产权期限
            </td>
            <td style="padding-left:10px;">
                <input type="text" name="property_deadline" value="<{$data.property_deadline}>" class="form-control" style="width:100px;float:left" />
                <span style="margin-left:5px;float:left;line-height: 33px">年</span>
            </td>
        </tr>
        <tr>
            <td width="140" valign="bottom" style="padding-bottom:25px;">
                楼盘坐标
            </td>
            <td style="padding-left:10px;padding-top:15px" align="left">
                <div style="float:left;margin-top:240px;margin-left:00px;margin-right:25px;">地图：</div>
                <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=7b92b3afff29988b6d4dbf9a00698ed8"></script>
                <div style="width:700px; margin-bottom: 20px;">
                    <div id="r-result">关键字:<input type="text" id="suggestId" class="mapinputs" size="20" value="合肥" /></div>
                </div>
                <div id="searchResultPanel" style="border:1px solid #C0C0C0;width:150px;height:auto; display:none;"></div>
                <div id="allmap" style="width: 600px; height:500px;"></div>
                <script type="text/javascript">
                    // 百度地图API功能
                    var map = new BMap.Map("allmap");
                    var lng = "<{$data.lng}>";
                    var lat = "<{$data.lat}>";
                    if(!lng&&!lat){
                        map.centerAndZoom("合肥");
                        var point = new BMap.Point(117.260852,31.825717);
                    }else{
                        map.centerAndZoom(new BMap.Point(lng,lat), 15);
                        var point = new BMap.Point(lng,lat);
                    }
                    map.centerAndZoom(point, 15);
                    var marker = new BMap.Marker(point);  // 创建标注
                    map.clearOverlays();
                    map.addOverlay(marker);              // 将标注添加到地图中
                    marker.setAnimation(BMAP_ANIMATION_BOUNCE); //跳动的动画
                    function showPoint(e) {
                        document.getElementById('lat').value = e.point.lat;
                        document.getElementById('lng').value = e.point.lng;
                        var p = new BMap.Point(e.point.lng,e.point.lat);
                        var mk = new BMap.Marker(p);
                        map.clearOverlays();
                        map.addOverlay(mk);
                        mk.setAnimation(BMAP_ANIMATION_BOUNCE); //跳动的动画
                    }
                    map.enableScrollWheelZoom(true);
                    map.addControl(new BMap.NavigationControl());  //添加默认缩放平移控件
                    map.addControl(new BMap.NavigationControl({anchor: BMAP_ANCHOR_TOP_RIGHT, type: BMAP_NAVIGATION_CONTROL_SMALL}));  //右上角，仅包含平移和缩放按钮
                    map.addControl(new BMap.NavigationControl({anchor: BMAP_ANCHOR_BOTTOM_LEFT, type: BMAP_NAVIGATION_CONTROL_PAN}));  //左下角，仅包含平移按钮
                    map.addControl(new BMap.NavigationControl({anchor: BMAP_ANCHOR_BOTTOM_RIGHT, type: BMAP_NAVIGATION_CONTROL_ZOOM}));  //右下角，仅包含缩放按钮
                    map.addEventListener("click", showPoint);
                    function G(id) {
                        return document.getElementById(id);
                    }

                    var ac = new BMap.Autocomplete(//建立一个自动完成的对象
                            {"input": "suggestId"
                                , "location": map
                            });

                    ac.addEventListener("onhighlight", function (e) {  //鼠标放在下拉列表上的事件
                        var str = "";
                        var _value = e.fromitem.value;
                        var value = "";
                        if (e.fromitem.index > -1) {
                            value = _value.province + _value.city + _value.district + _value.street + _value.business;
                        }
                        str = "FromItem<br />index = " + e.fromitem.index + "<br />value = " + value;

                        value = "";
                        if (e.toitem.index > -1) {
                            _value = e.toitem.value;
                            value = _value.province + _value.city + _value.district + _value.street + _value.business;
                        }
                        str += "<br />ToItem<br />index = " + e.toitem.index + "<br />value = " + value;
                        G("searchResultPanel").innerHTML = str;
                    });

                    var myValue;
                    ac.addEventListener("onconfirm", function (e) {    //鼠标点击下拉列表后的事件
                        var _value = e.item.value;
                        myValue = _value.province + _value.city + _value.district + _value.street + _value.business;
                        G("searchResultPanel").innerHTML = "onconfirm<br />index = " + e.item.index + "<br />myValue = " + myValue;

                        setPlace();
                    });


                    function setPlace() {
                        map.clearOverlays();    //清除地图上所有覆盖物
                        function myFun() {
                            var pp = local.getResults().getPoi(0).point;    //获取第一个智能搜索的结果
                            map.centerAndZoom(pp, 18);
                            var kk = new BMap.Marker(pp);
                            map.addOverlay(kk);    //添加标注
                            kk.setAnimation(BMAP_ANIMATION_BOUNCE); //跳动的动画
                        }
                        var local = new BMap.LocalSearch(map, {//智能搜索
                            onSearchComplete: myFun
                        });
                        local.search(myValue);
                    }

                </script>
                <div style="margin-top:40px;margin-bottom:15px;">
                    <span><input type="text" style="width:140px;height: 30px;"  class="disabled" readonly  name="lng" id="lng" value="<{$data.lng}>" />经度</span>
                    <span><input type="text" style="width:140px;height: 30px;"  name="lat" class="disabled" readonly id="lat" value="<{$data.lat}>" />纬度</span>
                </div>
            </td>
        </tr>
        <tr>
            <td valign="top" style="padding-top:25px;">
                详情
            </td>
            <td align="left" style="padding-top:20px;padding-bottom:20px;padding-left:10px;">
                <script type="text/plain" id="data_details" name="details" style="width:800px;height:225px;"><{$data.details}></script>
            </td>
        </tr>
        <link rel="stylesheet" href="__PUBLIC__/Scripts/umeditor/themes/default/css/umeditor.min.css" type="text/css">
        <script type="text/javascript" charset="utf-8" src="__PUBLIC__/Scripts/umeditor/umeditor.config.js"></script>
        <script type="text/javascript" charset="utf-8" src="__PUBLIC__/Scripts/umeditor/umeditor.min.js"></script>
        <script type="text/javascript" src="__PUBLIC__/Scripts/umeditor/lang/zh-cn/zh-cn.js"></script>
        <script>
            um = UM.getEditor('data_details', {
                imageUrl: "<{:U('public/editor')}>",
                imagePath: '__ROOT__/attachs/editor/',
                lang: 'zh-cn',
                langPath: UMEDITOR_CONFIG.UMEDITOR_HOME_URL + "lang/",
                focus: false
            });
        </script>
        <script>
            um = UM.getEditor('data_details', {
                imageUrl: "<{:U('public/editor')}>",
                imagePath: '__ROOT__/attachs/editor/',
                lang: 'zh-cn',
                langPath: UMEDITOR_CONFIG.UMEDITOR_HOME_URL + "lang/",
                focus: false
            });
        </script>
    </table>
    <div style="margin-top:45px;margin-left:140px;">
        <input  type="submit" class="btn btn-primary" value="确认添加" />
    </div>
    </form>
</div>
<script>
    $(function(){
        $('td').css({'border-color':'rgb(225,225,225)','border':'1px solid rgb(225,225,225)'});
    });
</script>
<include  file='public:footer'/>     